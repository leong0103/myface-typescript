<html lang="en-gb">
<%- include('_head') -%>
<%- include('_header') -%>
<body>
    <div class="page-content">
        <h2 class="page-title">Posts</h2>
        <ol class="post-list">
            <% postList.results.forEach(function(post) {%>
                <div class="post-detail">
                    <li>
                        <h3><%= post.postedBy.username %></h3>
                        <img src="<%= post.imageUrl %>" alt="Post Image">
                        <p>&#128077; <%= post.likedBy.length %> | &#128078; <%= post.dislikedBy.length %> | <%= format(post.createdAt, "yyyy-MM-dd HH:mm") %></p>

                        <% if (!post.likedBy.some(like => like?.id === 1) && !post.dislikedBy.some(dislike => dislike?.id === 1)) { %>
                            <form method="post"
                            action= "<%= `/posts/${post.id}/like/`%>">
                                <button type="submit">LIKE</button>
                            </form>
                            <form method="post" action= "<%= `/posts/${post.id}/dislike/` %>">
                                <button type="submit">DISLIKE</button>
                            </form> 
                                            
                        <% } %>
                        <p><%= post.message %></p>
                    </li>
                </div>
            <% }); %>
        </ol>
    </div>
<%if (postList.next) { %>
    <a href="<%= postList.next %>">Next</a>
<% } %>
<%if (postList.previous) { %>
    <a href="<%= postList.previous %>">Previous</a>
<% } %>
</body>
<%- include('_footer') -%>
</html>